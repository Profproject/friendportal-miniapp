<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>FriendPortal</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
*{box-sizing:border-box}
html,body{
  margin:0;padding:0;width:100%;height:100%;
  background:#000;overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif
}
.app{
  position:relative;
  max-width:480px;
  height:100vh;
  margin:0 auto;
  background:url("bg.png") center top/cover no-repeat;
  overflow:hidden
}
.coin{
  position:absolute;width:70px;height:70px;
  pointer-events:none;z-index:1;
  object-fit:contain
}
.buttons{
  position:absolute;bottom:20px;width:100%;
  padding:0 16px;display:flex;
  flex-direction:column;gap:10px;z-index:5
}
.btn-img{display:flex;cursor:pointer;user-select:none}
.btn-img.left{justify-content:flex-start}
.btn-img.right{justify-content:flex-end}
.btn-img img{
  max-width:250px;border-radius:18px;
  transition:.12s
}
.btn-img.pressed img{
  transform:translateY(6px) scale(.94);
  filter:brightness(.85)
}
.modal{
  position:fixed;inset:0;display:none;
  align-items:center;justify-content:center;
  background:rgba(0,0,0,.65);
  backdrop-filter:blur(6px);z-index:20
}
.modal-content{
  width:90%;max-height:85%;
  background:linear-gradient(180deg,#111,#1b1b1b);
  border-radius:22px;padding:22px;color:#fff;
  overflow-y:auto
}
.modal-content h2{color:#ffd87a}
.modal-content button{
  margin-top:20px;width:100%;padding:14px;
  border-radius:14px;border:none;
  background:linear-gradient(180deg,#4e6cff,#2f46ff);
  color:#fff;font-size:16px
}
#soundToggle{
  position:absolute;bottom:12px;right:12px;
  z-index:30;font-size:22px
}
</style>
</head>

<body>
<div class="app">

<audio id="clickSound" src="click.mp3"></audio>
<audio id="bgMusic" src="bg.mp3" loop></audio>
<div id="soundToggle">ðŸ”Š</div>

<img src="coin1.png" class="coin">
<img src="coin13.png" class="coin">
<img src="coin94.png" class="coin">
<img src="coin108.png" class="coin">
<img src="coin216.png" class="coin">

<div class="buttons">
  <div class="btn-img left" onclick="invite()"><img src="inv.png"></div>
  <div class="btn-img right" onclick="getBalance()"><img src="bal.png"></div>
  <div class="btn-img left" onclick="withdraw()"><img src="wit.png"></div>
  <div class="btn-img right" onclick="getStats()"><img src="sta.png"></div>
  <div class="btn-img left" onclick="openHow()"><img src="how.png"></div>
  <div class="btn-img right" onclick="payActivate()"><img src="act.png"></div>
  <div class="btn-img left" onclick="ads()"><img src="for.png"></div>
</div>

<div class="modal" id="howModal">
<div class="modal-content">
<h2>ðŸš€ How FriendPortal works</h2>
<p><b>FriendPortal</b> â€” referral earning platform on TON.</p>
<ul>
<li>ðŸ‘¥ Invite users</li>
<li>ðŸ”“ Activation â€” 1 TON</li>
<li>ðŸ’Ž Earn from referrals</li>
</ul>
<p><b>Levels</b></p>
<ul>
<li>Level 1 â€” 0.5 TON</li>
<li>Level 2 â€” 0.25 TON</li>
</ul>
<p><b>Advertising</b></p>
<ul>
<li>25 TON â€” broadcast</li>
<li>75 TON â€” top (7 days)</li>
<li>250 TON â€” top (30 days)</li>
</ul>
<button onclick="closeHow()">Close</button>
</div>
</div>

<script>
const API="https://loyce-taxitic-elenora.ngrok-free.dev";
const BOT="FriendPortal_bot";
const tg=Telegram.WebApp;
tg.expand();

const user_id=tg.initDataUnsafe?.user?.id;

const click=document.getElementById("clickSound");
const music=document.getElementById("bgMusic");
let sound=true;

document.getElementById("soundToggle").onclick=()=>{
  sound=!sound;
  document.getElementById("soundToggle").textContent=sound?"ðŸ”Š":"ðŸ”‡";
  sound?music.play():music.pause();
};

document.querySelectorAll(".btn-img").forEach(b=>{
  b.addEventListener("pointerdown",()=>{b.classList.add("pressed");if(sound)click.play()});
  b.addEventListener("pointerup",()=>b.classList.remove("pressed"));
});

const coins=document.querySelectorAll(".coin");
const W=window.innerWidth,H=window.innerHeight;
const data=[...coins].map(()=>({x:Math.random()*(W-70),y:Math.random()*(H-70),vx:Math.random()*2+1,vy:Math.random()*2+1}));

function animate(){
  coins.forEach((c,i)=>{
    const d=data[i];
    d.x+=d.vx;d.y+=d.vy;
    if(d.x<0||d.x>W-70)d.vx*=-1;
    if(d.y<0||d.y>H-70)d.vy*=-1;
    c.style.transform=`translate(${d.x}px,${d.y}px)`;
  });
  requestAnimationFrame(animate);
}
animate();

function invite(){
  const link=`https://t.me/${BOT}?startapp=${user_id}`;
  tg.openTelegramLink(`https://t.me/share/url?url=${encodeURIComponent(link)}`);
}

async function getBalance(){
  const r=await fetch(API+"/balance",{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id})});
  const d=await r.json();
  alert(`ðŸ’° Balance: ${d.balance} TON\nActivated: ${d.activated}`);
}

async function getStats(){
  const r=await fetch(API+"/stats",{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id})});
  const d=await r.json();
  alert(`Level1: ${d.level1}\nLevel2: ${d.level2}\nEarned: ${d.earned} TON`);
}

async function payActivate(){
  const r=await fetch(API+"/pay",{method:"POST",headers:{'Content-Type':'application/json'},body:JSON.stringify({user_id})});
  const d=await r.json();
  tg.openLink(`ton://transfer/${d.address}?amount=${d.amount*1e9}&text=${encodeURIComponent(d.comment)}`);
}

function withdraw(){alert("Minimum withdrawal: 5 TON")}
function ads(){alert("Advertising packages available")}
function openHow(){howModal.style.display="flex"}
function closeHow(){howModal.style.display="none"}
</script>
</div>
</body>
</html>
